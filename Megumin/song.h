// Unique durations (ms)
const uint16_t durationVals[] PROGMEM = {125, 250, 500, 750, 1125, 1375, 1500, 2125, 2875};

// Melody array
const uint16_t melody[] PROGMEM = {
  523,523,587,659,659,784,880,1047,880,784,659,659,587,523,
  880,784,659,587,392,523,523,587,523,
  523,523,587,659,659,784,880,1047,880,784,659,659,587,523,
  523,587,659,500,698,784,880,784,659,587,
  784,659,659,698,784,880,784,880,1047,988,1047,659,698,784,
  659,523,440,523,587,659,587,523,587,523,
  523,659,784,1047,523,659,1047,587,784,1175,659,784,988,1319,
  659,784,1319,784,988,1568,880,1047,1319,1760,1047,1319,1047,880,
  1047,1319,1760,784,988,1568,659,784,1047,1319,659,1047,1319,587,
  784,1175,523,659,784,1047,523,659,1047,587,784,1175,659,784,988,
  1319,659,784,1319,784,988,1568,880,1047,1319,1760,1047,1319,1047,880,
  1047,1319,1760,784,988,1568,659,784,1047,1319,659,784,1047,1319,
  698,1397,784,988,1319,1568,880,1760,784,1047,1319,1568,659,1319,587,
  784,988,1175,523,659,880,1047,880,1047,1319,1760,784,988,1319,1568,
  659,784,1319,587,784,1175,392,784,523,880,1047,523,659,880,1047,
  587,1175,659,784,1319,587,1175,523,659,1047,587,1175,523,2875,659,2875,1047,2875,
  523,1500,659,1375,784,1375,1047,1250
};

// Duration indices (index into durationVals)
const uint8_t durationIdx[] PROGMEM = {
2,1,0,2,1,0,0,0,0,0,2,1,0,2,
2,1,0,0,0,2,1,0,5,
0,2,2,0,2,2,0,0,0,0,0,0,0,0,
2,1,0,2,1,0,2,2,0,0,0,0,0,0,
0,2,2,0,2,1,2,2,0,2,1,0,2,2,
0,2,2,0,2,2,0,2,1,0,0,2,0,
0,1,2,2,0,2,1,2,0,0,2,2,0,2,
2,0,2,1,0,0,0,2,1,0,2,2,0,
2,2,0,2,2,0,2,1,0,0,2,0,0,0,
0,0,0,0,0,0,0,0,0
};

// Playback function
void playSong(int buzzerPin) {
  for (uint16_t i=0; i<sizeof(melody)/sizeof(melody[0]); i++) {
    uint16_t freq = pgm_read_word(&melody[i]);
    uint16_t dur  = pgm_read_word(&durationVals[pgm_read_byte(&durationIdx[i])]);
    if(freq) tone(buzzerPin, freq);
    delay(dur);
    noTone(buzzerPin);
  }
}